"use strict";(self.webpackChunkperformance_demo_client=self.webpackChunkperformance_demo_client||[]).push([[42],{42:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var r=a(950),t=a(920),n=a(895),i=a(224),l=a(397),c=a(414);const d=(0,r.memo)(e=>{let{user:s}=e;return(0,c.jsx)("div",{className:"card",children:(0,c.jsxs)("div",{className:"user-info",children:[s.avatar&&(0,c.jsx)("img",{src:s.avatar,alt:s.name,className:"user-avatar",loading:"lazy",width:"60",height:"60"}),(0,c.jsxs)("div",{className:"user-details",children:[(0,c.jsx)("h3",{children:s.name}),(0,c.jsx)("p",{children:s.email}),(0,c.jsxs)("small",{children:["Joined: ",new Date(s.createdAt).toLocaleDateString()]})]})]})})});d.displayName="UserCard";const o=(0,r.memo)(e=>{let{index:s,style:a,data:r}=e;const t=r[s];return(0,c.jsx)("div",{style:a,children:(0,c.jsx)(d,{user:t})})});o.displayName="VirtualizedUserItem";const h=async e=>{let{queryKey:s}=e;const[,a,r]=s,t=new URLSearchParams({page:a.toString(),limit:r.toString()}),n=await fetch("/api/users?".concat(t));if(!n.ok)throw new Error("Failed to fetch users");return n.json()},u=(0,r.memo)(()=>{const[e,s]=(0,r.useState)(1),[a]=(0,r.useState)(20),[u,m]=(0,r.useState)(""),[x,g]=(0,r.useState)(!1),j=(0,r.useMemo)(()=>(0,l.debounce)(e=>{m(e)},300),[]);r.useEffect(()=>()=>{j.cancel()},[j]);const p=(0,r.useCallback)(e=>{j(e.target.value)},[j]),{data:v,isLoading:y,error:f,isFetching:N}=(0,t.useQuery)(["users",e,a],h,{keepPreviousData:!0,staleTime:3e5}),{data:w}=(0,t.useQuery)(["search-users",u],()=>(async e=>{if(!e||e.length<2)return{results:[]};const s=await fetch("/api/search?q=".concat(encodeURIComponent(e),"&type=users"));if(!s.ok)throw new Error("Failed to search users");return s.json()})(u),{enabled:u.length>=2,staleTime:12e4}),k=(0,r.useMemo)(()=>u&&w?w.results||[]:(null===v||void 0===v?void 0:v.users)||[],[u,w,v]),b=(0,r.useMemo)(()=>u?null:null===v||void 0===v?void 0:v.pagination,[u,v]),C=(0,r.useCallback)(e=>{s(e),window.scrollTo({top:0,behavior:"smooth"})},[]);return f?(0,c.jsxs)("div",{className:"card",children:[(0,c.jsx)("h2",{children:"Error loading users"}),(0,c.jsx)("p",{children:f.message})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.mg,{children:[(0,c.jsx)("title",{children:"Users - Performance Demo"}),(0,c.jsx)("meta",{name:"description",content:"Browse our user directory with fast search and pagination"})]}),(0,c.jsxs)("div",{className:"card",children:[(0,c.jsx)("h1",{children:"Users"}),(0,c.jsx)("div",{className:"search-container",children:(0,c.jsx)("input",{type:"text",placeholder:"Search users...",onChange:p,className:"search-input"})}),(0,c.jsx)("div",{className:"controls",children:(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"checkbox",checked:x,onChange:e=>g(e.target.checked)}),"Use Virtualization (for large lists)"]})}),y&&(0,c.jsx)("div",{className:"loading-spinner",children:(0,c.jsx)("div",{className:"spinner"})}),N&&!y&&(0,c.jsx)("p",{children:"Updating..."}),k.length>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h2",{children:u?"Search Results (".concat(k.length,")"):"Users (".concat((null===b||void 0===b?void 0:b.total)||k.length,")")}),x&&k.length>50?(0,c.jsx)("div",{style:{height:"600px",width:"100%"},children:(0,c.jsx)(i.Y1,{height:600,itemCount:k.length,itemSize:120,itemData:k,children:o})}):(0,c.jsx)("div",{className:"card-grid",children:k.map(e=>(0,c.jsx)(d,{user:e},e._id||e.id))})]}),b&&b.pages>1&&(0,c.jsxs)("div",{className:"pagination",children:[(0,c.jsx)("button",{onClick:()=>C(e-1),disabled:1===e,children:"Previous"}),Array.from({length:Math.min(5,b.pages)},(s,a)=>{const r=Math.max(1,e-2)+a;return r>b.pages?null:(0,c.jsx)("button",{onClick:()=>C(r),className:r===e?"active":"",children:r},r)}),(0,c.jsx)("button",{onClick:()=>C(e+1),disabled:e===b.pages,children:"Next"})]}),0===k.length&&!y&&(0,c.jsx)("p",{children:"No users found. Try adjusting your search."})]})]})});u.displayName="Users";const m=u}}]);