"use strict";(self.webpackChunkperformance_demo_client=self.webpackChunkperformance_demo_client||[]).push([[548],{548:(e,i,s)=>{s.r(i),s.d(i,{default:()=>o});var a=s(379),t=s(950),r=s(895),n=s(414);const l=(0,t.memo)(()=>{const[e,i]=(0,t.useState)(null),[s,l]=(0,t.useState)(null),[o,c]=(0,t.useState)(!1),[d,m]=(0,t.useState)({width:800,quality:80,format:"webp"}),[h,p]=(0,t.useState)(null),g=(0,t.useRef)(null),x=(0,t.useCallback)(e=>{const s=e.target.files[0];if(s&&s.type.startsWith("image/")){const e=new FileReader;e.onload=e=>{i(e.target.result),l(null),p(null)},e.readAsDataURL(s)}},[]),u=(0,t.useCallback)(async()=>{if(e){c(!0);try{const i=await fetch(e),s=await i.blob(),a=new FormData;a.append("image",s,"image.jpg"),a.append("width",d.width.toString()),a.append("quality",d.quality.toString()),a.append("format",d.format);const t=await fetch("/api/optimize-image",{method:"POST",body:a});if(!t.ok)throw new Error("Failed to optimize image");const r=await t.blob(),n=URL.createObjectURL(r);l(n);const o=s.size,c=r.size,m=((o-c)/o*100).toFixed(1);p({originalSize:o,optimizedSize:c,compressionRatio:m,format:d.format,width:d.width,quality:d.quality})}catch(i){console.error("Error optimizing image:",i),alert("Failed to optimize image. Please try again.")}finally{c(!1)}}},[e,d]),j=(0,t.useCallback)(e=>{if(0===e)return"0 Bytes";const i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(2))+" "+["Bytes","KB","MB","GB"][i]},[]),f=(0,t.useCallback)(()=>{i(null),l(null),p(null),g.current&&(g.current.value="")},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.mg,{children:[(0,n.jsx)("title",{children:"Image Optimizer - Performance Demo"}),(0,n.jsx)("meta",{name:"description",content:"Optimize your images for better web performance"})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h1",{children:"Image Optimizer"}),(0,n.jsx)("p",{children:"Upload an image to see how optimization can reduce file size while maintaining quality. This tool demonstrates server-side image optimization using Sharp."}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Select Image:"}),(0,n.jsx)("input",{ref:g,type:"file",accept:"image/*",onChange:x})]}),e&&(0,n.jsxs)("div",{className:"optimization-settings",children:[(0,n.jsx)("h3",{children:"Optimization Settings"}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Width (px):"}),(0,n.jsx)("input",{type:"number",value:d.width,onChange:e=>m(i=>(0,a.A)((0,a.A)({},i),{},{width:parseInt(e.target.value)})),min:"100",max:"2000"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Quality (%):"}),(0,n.jsx)("input",{type:"range",min:"10",max:"100",value:d.quality,onChange:e=>m(i=>(0,a.A)((0,a.A)({},i),{},{quality:parseInt(e.target.value)}))}),(0,n.jsxs)("span",{children:[d.quality,"%"]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Format:"}),(0,n.jsxs)("select",{value:d.format,onChange:e=>m(i=>(0,a.A)((0,a.A)({},i),{},{format:e.target.value})),children:[(0,n.jsx)("option",{value:"webp",children:"WebP"}),(0,n.jsx)("option",{value:"jpeg",children:"JPEG"}),(0,n.jsx)("option",{value:"png",children:"PNG"}),(0,n.jsx)("option",{value:"avif",children:"AVIF"})]})]}),(0,n.jsx)("button",{onClick:u,className:"btn",disabled:o,children:o?"Optimizing...":"Optimize Image"}),(0,n.jsx)("button",{onClick:f,className:"btn btn-secondary",children:"Reset"})]}),e&&(0,n.jsxs)("div",{className:"image-comparison",children:[(0,n.jsxs)("div",{className:"image-section",children:[(0,n.jsx)("h3",{children:"Original Image"}),(0,n.jsx)("img",{src:e,alt:"Original",className:"image-preview",style:{maxWidth:"100%",height:"auto"}}),h&&(0,n.jsx)("div",{className:"image-stats",children:(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Size:"})," ",j(h.originalSize)]})})]}),s&&(0,n.jsxs)("div",{className:"image-section",children:[(0,n.jsx)("h3",{children:"Optimized Image"}),(0,n.jsx)("img",{src:s,alt:"Optimized",className:"image-preview",style:{maxWidth:"100%",height:"auto"}}),h&&(0,n.jsxs)("div",{className:"image-stats",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Size:"})," ",j(h.optimizedSize)]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Compression:"})," ",h.compressionRatio,"% smaller"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Format:"})," ",h.format.toUpperCase()]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Width:"})," ",h.width,"px"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Quality:"})," ",h.quality,"%"]})]})]})]}),(0,n.jsxs)("div",{className:"card",style:{marginTop:"2rem"},children:[(0,n.jsx)("h3",{children:"Image Optimization Tips"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Choose the right format:"})," WebP and AVIF offer better compression than JPEG/PNG"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Resize appropriately:"})," Don't serve images larger than needed for display"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Use responsive images:"})," Serve different sizes for different screen sizes"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Lazy load images:"})," Load images only when they're about to be visible"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Use CDN:"})," Serve images from a Content Delivery Network for faster loading"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Enable compression:"})," Use gzip/brotli compression for image delivery"]})]})]})]})]})});l.displayName="ImageOptimizer";const o=l}}]);