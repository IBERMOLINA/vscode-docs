"use strict";(self.webpackChunkperformance_demo_client=self.webpackChunkperformance_demo_client||[]).push([[120],{120:(e,s,a)=>{a.r(s),a.d(s,{default:()=>p});var t=a(379),r=a(950),n=a(920),c=a(895),i=a(224),l=a(397),o=a(414);const d=(0,r.memo)(e=>{let{product:s}=e;return(0,o.jsxs)("div",{className:"card",children:[(0,o.jsx)("h3",{children:s.name}),(0,o.jsx)("p",{children:s.description}),(0,o.jsxs)("div",{className:"product-details",children:[(0,o.jsxs)("span",{className:"price",children:["$",s.price]}),(0,o.jsx)("span",{className:"category",children:s.category})]}),s.images&&s.images.length>0&&(0,o.jsx)("img",{src:s.images[0],alt:s.name,className:"product-image",loading:"lazy",width:"200",height:"150"})]})});d.displayName="ProductCard";const h=(0,r.memo)(e=>{let{index:s,style:a,data:t}=e;const r=t[s];return(0,o.jsx)("div",{style:a,children:(0,o.jsx)(d,{product:r})})});h.displayName="VirtualizedProductItem";const u=async e=>{let{queryKey:s}=e;const[,a,r,n]=s,c=new URLSearchParams((0,t.A)({page:a.toString(),limit:r.toString()},n)),i=await fetch("/api/products?".concat(c));if(!i.ok)throw new Error("Failed to fetch products");return i.json()},m=(0,r.memo)(()=>{const[e,s]=(0,r.useState)(1),[a]=(0,r.useState)(20),[m,p]=(0,r.useState)(""),[g,x]=(0,r.useState)(""),[j,v]=(0,r.useState)(""),[y,b]=(0,r.useState)(""),[f,N]=(0,r.useState)(!1),C=(0,r.useMemo)(()=>(0,t.A)((0,t.A)((0,t.A)({},g&&{category:g}),j&&{minPrice:j}),y&&{maxPrice:y}),[g,j,y]),k=(0,r.useMemo)(()=>(0,l.debounce)(e=>{p(e)},300),[]);r.useEffect(()=>()=>{k.cancel()},[k]);const w=(0,r.useCallback)(e=>{k(e.target.value)},[k]),{data:P,isLoading:S,error:M,isFetching:A}=(0,n.useQuery)(["products",e,a,C],u,{keepPreviousData:!0,staleTime:3e5}),{data:F}=(0,n.useQuery)(["search",m],()=>(async e=>{if(!e||e.length<2)return{results:[]};const s=await fetch("/api/search?q=".concat(encodeURIComponent(e),"&type=products"));if(!s.ok)throw new Error("Failed to search products");return s.json()})(m),{enabled:m.length>=2,staleTime:12e4}),z=(0,r.useMemo)(()=>m&&F?F.results||[]:(null===P||void 0===P?void 0:P.products)||[],[m,F,P]),E=(0,r.useMemo)(()=>m?null:null===P||void 0===P?void 0:P.pagination,[m,P]),_=(0,r.useCallback)(e=>{s(e),window.scrollTo({top:0,behavior:"smooth"})},[]),T=(0,r.useCallback)(()=>{x(""),v(""),b(""),s(1)},[]);return M?(0,o.jsxs)("div",{className:"card",children:[(0,o.jsx)("h2",{children:"Error loading products"}),(0,o.jsx)("p",{children:M.message})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(c.mg,{children:[(0,o.jsx)("title",{children:"Products - Performance Demo"}),(0,o.jsx)("meta",{name:"description",content:"Browse our optimized product catalog with fast search and filtering"})]}),(0,o.jsxs)("div",{className:"card",children:[(0,o.jsx)("h1",{children:"Products"}),(0,o.jsx)("div",{className:"search-container",children:(0,o.jsx)("input",{type:"text",placeholder:"Search products...",onChange:w,className:"search-input"})}),(0,o.jsxs)("div",{className:"filters",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Category:"}),(0,o.jsxs)("select",{value:g,onChange:e=>x(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"All Categories"}),(0,o.jsx)("option",{value:"electronics",children:"Electronics"}),(0,o.jsx)("option",{value:"clothing",children:"Clothing"}),(0,o.jsx)("option",{value:"books",children:"Books"}),(0,o.jsx)("option",{value:"home",children:"Home & Garden"})]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Min Price:"}),(0,o.jsx)("input",{type:"number",value:j,onChange:e=>v(e.target.value),placeholder:"0"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Max Price:"}),(0,o.jsx)("input",{type:"number",value:y,onChange:e=>b(e.target.value),placeholder:"1000"})]}),(0,o.jsx)("button",{onClick:T,className:"btn btn-secondary",children:"Clear Filters"}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",checked:f,onChange:e=>N(e.target.checked)}),"Use Virtualization (for large lists)"]})]}),S&&(0,o.jsx)("div",{className:"loading-spinner",children:(0,o.jsx)("div",{className:"spinner"})}),A&&!S&&(0,o.jsx)("p",{children:"Updating..."}),z.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{children:m?"Search Results (".concat(z.length,")"):"Products (".concat((null===E||void 0===E?void 0:E.total)||z.length,")")}),f&&z.length>50?(0,o.jsx)("div",{style:{height:"600px",width:"100%"},children:(0,o.jsx)(i.Y1,{height:600,itemCount:z.length,itemSize:200,itemData:z,children:h})}):(0,o.jsx)("div",{className:"card-grid",children:z.map(e=>(0,o.jsx)(d,{product:e},e._id||e.id))})]}),E&&E.pages>1&&(0,o.jsxs)("div",{className:"pagination",children:[(0,o.jsx)("button",{onClick:()=>_(e-1),disabled:1===e,children:"Previous"}),Array.from({length:Math.min(5,E.pages)},(s,a)=>{const t=Math.max(1,e-2)+a;return t>E.pages?null:(0,o.jsx)("button",{onClick:()=>_(t),className:t===e?"active":"",children:t},t)}),(0,o.jsx)("button",{onClick:()=>_(e+1),disabled:e===E.pages,children:"Next"})]}),0===z.length&&!S&&(0,o.jsx)("p",{children:"No products found. Try adjusting your search or filters."})]})]})});m.displayName="Products";const p=m}}]);